---
title: æ‰‹å†™ç€‘å¸ƒæµ
tags: JS
---

ç€‘å¸ƒæµæ˜¯æˆ‘ä»¬ç»å¸¸ç”¨åˆ°çš„æ•ˆæœï¼Œå®ƒæœ‰ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯`ç­‰å®½ä¸å®šé«˜`

é‚£æˆ‘ä»¬å¦‚ä½•å®ç°ä¸€ä¸ªè¿™æ ·çš„æ•ˆæœå‘¢ï¼Œæˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥åšä¸€ä¸‹

<!-- more -->

é¦–å…ˆæˆ‘ä»¬å‡†å¤‡å®¹å™¨æ ·å¼å’Œæ¨¡æ‹Ÿæ•°æ®ï¼š

```html
<style>
    html, body, .container {
        margin: 0;
        height: 100vh;
    }
    .container {
        position: relative;
    }
    .container div {
        position: absolute;
        width: 120px;
    }
</style>

<div class="container"></div>

<script>
    let list =  [
        {
            height: 300,
            background: 'red'
        },
        ...
        ...
        {
            height: 400,
            background: 'pink'
        },
     ]
</script>
```

`list`å°±æ˜¯æˆ‘ä»¬å¸Œæœ›æ¸²æŸ“åˆ°é¡µé¢çš„æ•°æ®ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½ç›´æ¥å¾ªç¯æ¸²æŸ“åˆ°é¡µé¢ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´è°ƒæ•´æ•°ç»„é¡ºåºï¼Œè®¡ç®—æ¯ä¸€é¡¹å…ƒç´ çš„ä½ç½®ï¼Œæˆ‘ä»¬å‡†å¤‡ä¸€ä¸ª`renderList` æ¥ç››æ”¾æ–°æ•°æ®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å‡†å¤‡ä¸€ä¸ª`heightList`æ¥ç››æ”¾æ¯ä¸€è¡Œçš„å„ä¸ªå…ƒç´ çš„é«˜åº¦ã€‚

```js
let renderList = []  // ç”¨æ¥ç››æ”¾è¦æ¸²æŸ“çš„æ•°ç»„
let heightList = []  // ç››æ”¾æ¯ä¸€è¡Œå…ƒç´ çš„é«˜åº¦
```

é‚£ä¸€è¡Œåˆ°åº•ç››æ”¾å‡ ä¸ªå…ƒç´ å‘¢ï¼Œæˆ‘ä»¬æš‚å®šå…ƒç´ å®½åº¦`130px`ï¼Œé‚£å°±æ˜¯é¡µé¢å®½åº¦`document.body.clientWidth`é™¤å…ƒç´ å®½åº¦

```js
let column = Math.floor(document.body.clientWidth / 130)  // ä¸€è¡Œå‡ åˆ—
```

æ¥ä¸‹æ¥å°±æ˜¯å¾ªç¯`list` å…ˆä¸¢æ»¡ä¸€æ•´è¡Œï¼Œå¹¶è®°å½•ä½ç½®`left`ã€`top`

```js
list.forEach((item, index) => {
    if(index < column) {
        item.top = 0
        item.left = 130 * index

        renderList.push(item)
        heightList.push(item.height)  // è®°å½•ä¸‹ä¸€æ•´è¡Œå„ä¸ªå…ƒç´ çš„é«˜åº¦
    }
})
```

`renderList`ç¬¬ä¸€è¡Œæ•°æ®æˆ‘ä»¬å‡†å¤‡å¥½äº†ï¼Œæ¸²æŸ“åˆ°é¡µé¢çœ‹ä¸‹æ•ˆæœ

```js
let result = ``

renderList.forEach(item => {
    result += `<div style="
        height: ${item.height}px; 
        background: ${item.background}; 
        left: ${item.left}px; 
        top: ${item.top}px">
	</div>`
})

document.querySelector('.container').innerHTML = result
```

ç¬¬ä¸€è¡Œæå®šäº†ğŸ˜Š

æ¥ä¸‹æ¥éš¾ç‚¹æ¥äº†ï¼Œæˆ‘ä»¬éœ€è¦æ¥ç€å¾ªç¯`list`æ•°æ®å¹¶æ‰¾é«˜åº¦æœ€å°çš„é‚£ä¸€åˆ—ï¼ŒæŠŠæ•°æ®æ”¾åˆ°é«˜åº¦æœ€å°çš„ä¸‹è¾¹ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°`list`æ‰€æœ‰æ•°æ®å¾ªç¯å®Œæ¯•ï¼Œå¹¶æ¯ä¸€æ¬¡éƒ½æ”¾åˆ°é‡æ–°è®¡ç®—äº†æœ€å°åˆ—çš„ä¸‹è¾¹ã€‚

```js
list.forEach((item, index) => {
    if(index < column) {
        item.top = 0
        item.left = 130 * index

        renderList.push(item)
        heightList.push(item.height)  // è®°å½•ä¸‹ä¸€æ•´è¡Œå„ä¸ªå…ƒç´ çš„é«˜åº¦
    } else {  // æ•°æ®è¶…è¿‡ç¬¬ä¸€è¡Œï¼Œå°±éœ€è¦é€ä¸ªå…ƒç´ å»åˆ¤æ–­æ”¾ç½®çš„ä½ç½®
        let shotHeight = heightList[0]  // å‡è®¾ç¬¬ä¸€ä¸ªæ˜¯æœ€å°é«˜åº¦
        let shotIndex = 0  // å‡è®¾æœ€å°é«˜åº¦çš„åˆ—ç´¢å¼•

        heightList.forEach((heightItem, heightIndex) => {  // å¾ªç¯éå†é«˜åº¦åˆ—è¡¨
            if(shotHeight > heightItem) {  // å½“é«˜åº¦å°äºæ ‡è¯† åˆ™æ›¿æ¢
                shotHeight = heightItem
                shotIndex = heightIndex
            }
        })

        item.left = 130 * shotIndex  // è®¾ç½®æœ€å°é«˜åº¦åˆ—çš„å·¦åç§»
        item.top = shotHeight + 10  // ç»™æœ€å°é«˜åº¦åˆ—ä¸‹è¾¹ å¹¶ç•™10px é—´è·

        renderList.push(item)  // å°†å…ƒç´  æ”¾åˆ°æ¸²æŸ“æ•°ç»„

        heightList[shotIndex] = shotHeight + item.height  // æ›´æ–°heightlisté«˜åº¦åˆ—è¡¨
    }
})
```

å†æ¬¡æŸ¥çœ‹æ•ˆæœ,æˆåŠŸäº†ã€‚

æˆ‘ä»¬å¸Œæœ›é¡µé¢å¤§å°æ”¹å˜é‡æ–°è®¡ç®—å¹¶æ’åˆ—ï¼Œè´´ä¸Šå®Œæ•´ä»£ç ï¼š

```js
let list =  [
      {
          height: 300,
          background: 'red'
      },
   	  ...
      ...
      {
        height: 400,
        background: 'skyblue'
      }
    ]

    function renderListFn () {
      let renderList = []  // ç”¨æ¥ç››æ”¾è¦æ¸²æŸ“çš„æ•°ç»„
      let heightList = []  // ç››æ”¾æ¯ä¸€è¡Œå…ƒç´ çš„é«˜åº¦

      let column = Math.floor(document.body.clientWidth / 130)  // ä¸€è¡Œå‡ åˆ—

      list.forEach((item, index) => {
        if(index < column) {
          item.top = 0
          item.left = 130 * index

          renderList.push(item)
          heightList.push(item.height)  // è®°å½•ä¸‹ä¸€æ•´è¡Œå„ä¸ªå…ƒç´ çš„é«˜åº¦
        } else {  // æ•°æ®è¶…è¿‡ç¬¬ä¸€è¡Œï¼Œå°±éœ€è¦é€ä¸ªå…ƒç´ å»åˆ¤æ–­æ”¾ç½®çš„ä½ç½®
          let shotHeight = heightList[0]  // å‡è®¾ç¬¬ä¸€ä¸ªæ˜¯æœ€å°é«˜åº¦
          let shotIndex = 0  // å‡è®¾æœ€å°é«˜åº¦çš„åˆ—ç´¢å¼•

          heightList.forEach((heightItem, heightIndex) => {  // å¾ªç¯éå†é«˜åº¦åˆ—è¡¨
            if(shotHeight > heightItem) {  // å½“é«˜åº¦å°äºæ ‡è¯† åˆ™æ›¿æ¢
              shotHeight = heightItem
              shotIndex = heightIndex
            }
          })

          item.left = 130 * shotIndex  // è®¾ç½®æœ€å°é«˜åº¦åˆ—çš„å·¦åç§»
          item.top = shotHeight + 10  // ç»™æœ€å°é«˜åº¦åˆ—ä¸‹è¾¹ å¹¶ç•™10px é—´è·

          renderList.push(item)  // å°†å…ƒç´  æ”¾åˆ°æ¸²æŸ“æ•°ç»„

          heightList[shotIndex] = shotHeight + item.height  // æ›´æ–°heightlisté«˜åº¦åˆ—è¡¨


        }
      })

      let result = ``

      renderList.forEach(item => {
        result += `<div style="
          height: ${item.height}px; 
          background: ${item.background}; 
          left: ${item.left}px; 
          top: ${item.top}px"></div>`
      })

      document.querySelector('.container').innerHTML = result
    }

    renderListFn()

    window.onresize = renderListFn
```

